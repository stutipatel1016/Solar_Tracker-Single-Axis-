#include <Servo.h>

Servo solarServo;

// LDR pins
const int LDR_Left  = A0;
const int LDR_Right = A1;

// Servo pin
const int servoPin = 9;

// Servo positions
int servoPos = 90;           // current position
const int EAST_POS = 30;     // facing east (reset position)
const int WEST_POS = 150;    // max west position
const int SERVO_MIN = 20;
const int SERVO_MAX = 160;

// Sensitivity and thresholds
const int diffThreshold = 30;   // move only if difference > this
const int lightThreshold = 200; // below this, it's considered night

void setup() {
  Serial.begin(9600);
  solarServo.attach(servoPin);
  solarServo.write(servoPos);
  delay(500);
}

void loop() {
  int leftValue  = analogRead(LDR_Left);
  int rightValue = analogRead(LDR_Right);
  int avgLight   = (leftValue + rightValue) / 2;
  int diff       = leftValue - rightValue;

  Serial.print("Left: "); Serial.print(leftValue);
  Serial.print(" | Right: "); Serial.print(rightValue);
  Serial.print(" | Diff: "); Serial.print(diff);
  Serial.print(" | AvgLight: "); Serial.println(avgLight);

  if (avgLight < lightThreshold) {
    // ðŸŒ™ Night time â€” return to east position slowly
    if (servoPos > EAST_POS) {
      servoPos -= 1;
      servoPos = constrain(servoPos, SERVO_MIN, SERVO_MAX);
      solarServo.write(servoPos);
      delay(100);
    }
  } else {
    // ðŸŒž Day time â€” track the sun
    if (abs(diff) > diffThreshold) {
      if (diff > 0) {
        // Left LDR brighter â†’ move left (increase angle)
        servoPos += 1;
      } else {
        // Right LDR brighter â†’ move right (decrease angle)
        servoPos -= 1;
      }
      servoPos = constrain(servoPos, SERVO_MIN, SERVO_MAX);
      solarServo.write(servoPos);
    }
  }

  delay(150); // adjust for smoother or faster tracking
}
